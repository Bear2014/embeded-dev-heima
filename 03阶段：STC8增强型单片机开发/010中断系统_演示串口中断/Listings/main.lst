C51 COMPILER V9.60.7.0   MAIN                                                              02/25/2025 23:33:13 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          sfr   P3M1  = 0xb1;  // 这四个对应的灯地址不对，所以
   2          sfr   P3M0  = 0xb2;
   3          sfr   P3    = 0xb0;
   4          sbit  P34   = P3^4;
   5          
   6          sfr     T2L     =   0xd7;
   7          sfr     T2H     =   0xd6;
   8          sfr     AUXR    =   0x8e;
   9          
  10          sfr   IE    = 0xA8;
  11          sbit  EA    = IE^7;
  12          sbit  ES    = IE^4;
  13          
  14          sfr   SCON  = 0x98;
  15          sfr   SBUF  = 0x99;
  16          sbit  RI    = SCON^0;
  17          sbit  TI    = SCON^1;
  18          
  19          
  20          //当TI = 1的时候，会自动触发此中断函数
  21          void uart_hello(void) interrupt 4 {
  22   1        if(RI) {
  23   2          // 如果接收寄存器RI触发了中断，打开灯
  24   2          RI = 0;
  25   2          P34 = 1;//开
  26   2        } 
  27   1        
  28   1        if(TI) {
  29   2              // 如果发送寄存器TI触发了中断，关掉灯
  30   2          TI = 0;
  31   2          P34 = 0;//关
  32   2        }
  33   1      }
  34          
  35          
  36          void Delay1000ms(void)  //@24.000MHz
  37          {
  38   1        unsigned char data i, j, k;
  39   1        
  40   1        i = 122;
  41   1        j = 193;
  42   1        k = 128;
  43   1        do
  44   1        {
  45   2          do
  46   2          {
  47   3            while (--k);
  48   3          } while (--j);
  49   2        } while (--i);
  50   1      }
  51          
  52          int main() {
  53   1        P3M1 &= ~0x08,  P3M0 |=  0x08; //推挽输出
  54   1        
C51 COMPILER V9.60.7.0   MAIN                                                              02/25/2025 23:33:13 PAGE 2   

  55   1        SCON = 0x50;
  56   1        T2L = 0xe8; //65536-11059200/115200/4=0FFE8H
  57   1        T2H = 0xff;
  58   1        AUXR = 0x15;//启动定时器
  59   1        
  60   1        EA = 1; //全局中断
  61   1        ES = 1;
  62   1        
  63   1        P34 = 0;
  64   1        
  65   1        while(1) {
  66   2              // 休眠1000ms
  67   2          Delay1000ms();
  68   2          Delay1000ms();
  69   2          Delay1000ms();
  70   2          Delay1000ms();
  71   2          Delay1000ms();
  72   2              // 发送一个数据0x11
  73   2          SBUF = 0x11;
  74   2              // 将TI位寄存器置为1 (这里可以不设置, 只要给SBUF赋值了, TI也会自动变为1)
  75   2          TI = 1;
  76   2        }
  77   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     71    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
